name: X - Provision environment
run-name: Provision ${{ github.event.inputs.environment }}
on:
  workflow_dispatch:
    inputs:
      environment:
        type: choice
        description: Machine to provision
        default: qa
        required: true
        options:
          - development
          - staging
          - qa
          - production
          - backup
          - jump
          - e2e
          - v17
          - v19
      tag:
        type: choice
        description: Select group tag you want to execute
        default: all
        options:
          - all
          - application
          - backups
          - checks
          - crontab
          - data-partition
          - decrypt
          - deployment
          - docker
          - elasticsearch
          - fail2ban
          - jump
          - mongodb
          - swap
          - swarm
          - tools
          - traefik
          - ufw
          - updates
          - users
  workflow_call:
    inputs:
      environment:
        type: string
        description: Environment to deploy to
        required: true
      tag:
        type: string
        description: Environment to deploy to
        default: all
jobs:
  test:
    runs-on: ubuntu-24.04
    environment: ${{ inputs.environment }}
    steps:
        - name: Test variables
          run: |
            echo "environment: ${{ inputs.environment }}"
            echo "tag: ${{ inputs.tag }}"
            echo "repository: ${{ github.event.repository.name }}"
            echo "repository: ${{ github.event.repository.full_name }}"
            echo "github.repository: ${{ github.repository }}"
            echo "CUSTOM BRANCH: ${{ github.ref_name }}"